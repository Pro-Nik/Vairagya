<!DOCTYPE html>
<html>
<head>
  <title>Student Dashboard</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<!-- COURSE ACCESS MODAL -->
<div id="courseModal" class="modal">
  <div class="modal-content">
    <h3>üîê Course Access</h3>
    <p>Please enter the course access code provided by faculty OR Contact 7290951173 to get the code</p>

    <input type="password" id="courseCodeInput" placeholder="Enter course code">
    
    <div class="modal-actions">
      <button class="btn" onclick="verifyCourseCode()">Enter Course</button>
      <button class="btn-outline" onclick="closeCourseModal()">Cancel</button>
    </div>

    <p id="courseError" class="error-text"></p>
  </div>
</div>

<body onload="loadUser()">

<div class="dashboard">
  <aside>
    <h3>Dashboard</h3>
    <a href="dashboard.html">Courses</a>
    <a href="index.html" onclick="logout()">Logout</a>
  </aside>

  <main>
    <h2 id="welcome"></h2>

    <h3>My Courses</h3>

    <!-- üîç SEARCH BAR -->
    <input 
      type="text" 
      id="courseSearch" 
      placeholder="Search by course name, code or semester..."
      onkeyup="filterCourses()"
      class="course-search"
    >

    <div class="course-grid" id="courseGrid">

      <div class="course-card" data-name="Machine Learning" data-code="ML" data-sem="NA">
        <h3>Machine Learning</h3>
        <p><strong>Code:</strong> ML</p>
        <p><strong>Semester:</strong> NA</p>
        <!-- <a href="course.html?course=ML" class="btn">View Course</a> -->
        <button class="btn" onclick="openCourseModal('ML')">View Course</button>

   
      </div>

      <div class="course-card" data-name="Artificial Intelligence" data-code="AI" data-sem="NA">
        <h3>Artificial Intelligence</h3>
        <p><strong>Code:</strong> AI</p>
        <p><strong>Semester:</strong> NA</p>
        <!-- <a href="course.html?course=AI" class="btn">View Course</a> -->
        <button class="btn" onclick="openCourseModal('AI')">View Course</button>

      </div>

      <div class="course-card" data-name="Database Management Systems" data-code="DBMS" data-sem="NA">
        <h3>DBMS</h3>
        <p><strong>Code:</strong> DBMS</p>
        <p><strong>Semester:</strong> NA</p>
        <!-- <a href="course.html?course=DBMS" class="btn">View Course</a> -->
        <button class="btn" onclick="openCourseModal('DBMS')">View Course</button>

      </div>

      <div class="course-card" data-name="Deep Learning" data-code="DL" data-sem="NA">
        <h3>Deep Learning</h3>
        <p><strong>Code:</strong> DL</p>
        <p><strong>Semester:</strong> NA</p>
        <!-- <a href="course.html?course=DL" class="btn">View Course</a> -->
        <button class="btn" onclick="openCourseModal('DL')">View Course</button>

      </div>




      <div class="course-card" data-name="Reinforcement Learning" data-code="RL" data-sem="NA">
        <h3>Reinforcement Learning</h3>
        <p><strong>Code:</strong> RL</p>
        <p><strong>Semester:</strong> NA</p>
        <!-- <a href="course.html?course=DL" class="btn">View Course</a> -->
        <button class="btn" onclick="openCourseModal('RL')">View Course</button>

      </div>

    </div>

  </main>
</div>

<script src="js/auth.js"></script>
<script src="js/student.js"></script>

<!-- üîé SEARCH SCRIPT -->
<script>
function filterCourses() {
  const query = document.getElementById("courseSearch").value.toLowerCase();
  const courses = document.querySelectorAll(".course-card");

  courses.forEach(course => {
    const name = course.dataset.name.toLowerCase();
    const code = course.dataset.code.toLowerCase();
    const sem  = course.dataset.sem.toLowerCase();

    if (name.includes(query) || code.includes(query) || sem.includes(query)) {
      course.style.display = "block";
    } else {
      course.style.display = "none";
    }
  });
}
</script>


<script>
let selectedCourse = "";

/* =========================
   ENCODED COURSE CODES
   (basic obfuscation)
========================= */
const COURSE_CODES = {
  ML:   "TUwyMDI1",      // btoa("ML2025")
  AI:   "QUkyMDI1",      // btoa("AI2025")
  DBMS: "REJNUzIwMjU=",  // btoa("DBMS2025")
  DL:   "REwyMDI1" ,
  RL: "UkwyMDI1"      // btoa("DL2025")
};

function openCourseModal(course) {
  selectedCourse = course;
  document.getElementById("courseModal").style.display = "block";
  document.getElementById("courseCodeInput").value = "";
  document.getElementById("courseError").innerText = "";
}

function closeCourseModal() {
  document.getElementById("courseModal").style.display = "none";
}

function verifyCourseCode() {
  const inputCode = document.getElementById("courseCodeInput").value.trim();

  if (btoa(inputCode) === COURSE_CODES[selectedCourse]) {
    // store temporary session token
    sessionStorage.setItem("course_access", selectedCourse);
    window.location.href = `course.html?course=${selectedCourse}`;
  } else {
    document.getElementById("courseError").innerText =
      "‚ùå Invalid course access code";
  }
}
</script>





</body>
</html>
